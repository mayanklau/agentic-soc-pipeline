# Agentic SOC Pipeline - Environment Configuration
# Copy this file to .env and customize for your environment

# =============================================================================
# General Settings
# =============================================================================
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# =============================================================================
# Kafka Configuration
# =============================================================================
KAFKA_BOOTSTRAP_SERVERS=localhost:9092
KAFKA_SECURITY_PROTOCOL=PLAINTEXT
# KAFKA_SASL_MECHANISM=PLAIN
# KAFKA_SASL_USERNAME=
# KAFKA_SASL_PASSWORD=

# Topics
KAFKA_EVENTS_TOPIC=soc.events.raw
KAFKA_ALERTS_TOPIC=soc.alerts
KAFKA_AGENT_MESSAGES_TOPIC=soc.agents.messages

# =============================================================================
# Redis Configuration (Working Memory)
# =============================================================================
REDIS_URL=redis://localhost:6379
REDIS_DB=0
REDIS_MAX_CONNECTIONS=50

# =============================================================================
# Neo4j Configuration (Semantic Memory)
# =============================================================================
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=password123
NEO4J_DATABASE=neo4j

# =============================================================================
# ChromaDB Configuration (Episodic Memory)
# =============================================================================
CHROMA_HOST=localhost
CHROMA_PORT=8000
CHROMA_INCIDENTS_COLLECTION=soc_incidents
CHROMA_ALERTS_COLLECTION=soc_alerts

# =============================================================================
# PostgreSQL Configuration (Procedural Memory)
# =============================================================================
POSTGRES_URL=postgresql://postgres:postgres@localhost:5432/soc
POSTGRES_POOL_SIZE=20

# =============================================================================
# Ollama Configuration (LLM Inference)
# =============================================================================
OLLAMA_HOST=http://localhost:11434
OLLAMA_TIMEOUT=120.0

# Model Configuration
OLLAMA_ORCHESTRATOR_MODEL=phi3:14b-medium-128k-instruct-q4_K_M
OLLAMA_TRIAGE_MODEL=phi3:mini
OLLAMA_MALWARE_MODEL=codellama:7b
OLLAMA_NETWORK_MODEL=mistral:7b
OLLAMA_IDENTITY_MODEL=phi3:mini
OLLAMA_THREAT_INTEL_MODEL=llama3:8b
OLLAMA_RESPONSE_MODEL=phi3:mini

# =============================================================================
# Agent Configuration
# =============================================================================
AGENT_DEFAULT_TEMPERATURE=0.1
AGENT_DEFAULT_MAX_TOKENS=2048
AGENT_DEFAULT_TIMEOUT_SECONDS=60
AGENT_TRIAGE_BATCH_SIZE=50
AGENT_TRIAGE_CONFIDENCE_THRESHOLD=0.85
AGENT_AUTO_CONTAIN_THRESHOLD=0.90

# =============================================================================
# Quality Framework
# =============================================================================
QUALITY_HALT_ON_CRITICAL_FAILURE=true
QUALITY_MAX_NULL_PERCENTAGE=0.05
QUALITY_MAX_STALE_SECONDS=300
QUALITY_ANOMALY_SENSITIVITY=0.8
QUALITY_ALERT_COOLDOWN_MINUTES=15

# Alerting
QUALITY_SLACK_WEBHOOK_URL=
QUALITY_PAGERDUTY_API_KEY=

# =============================================================================
# External Integrations
# =============================================================================

# SIEM - Splunk
INTEGRATION_SPLUNK_HOST=
INTEGRATION_SPLUNK_TOKEN=

# SIEM - Elastic
INTEGRATION_ELASTIC_HOST=
INTEGRATION_ELASTIC_API_KEY=

# EDR - CrowdStrike
INTEGRATION_CROWDSTRIKE_CLIENT_ID=
INTEGRATION_CROWDSTRIKE_CLIENT_SECRET=

# EDR - SentinelOne
INTEGRATION_SENTINELONE_API_KEY=

# Threat Intelligence
INTEGRATION_VIRUSTOTAL_API_KEY=
INTEGRATION_MISP_URL=
INTEGRATION_MISP_API_KEY=
INTEGRATION_ABUSEIPDB_API_KEY=

# =============================================================================
# API Configuration
# =============================================================================
API_HOST=0.0.0.0
API_PORT=8080
API_WORKERS=4
API_CORS_ORIGINS=["*"]
